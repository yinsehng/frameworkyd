package com.neusoft.service.impl;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import javax.annotation.Resource;

import org.springframework.stereotype.Service;

import com.neusoft.dao.IAC01Dao;
import com.neusoft.service.IAllPersonCountService;
import com.neusoft.util.ConvertDataToRMUtil;
import com.neusoft.util.ResultModel;
import com.neusoft.util.SqlUtil;

@Service
public class AllPersonCountServiceImpl implements IAllPersonCountService{

	private static final String TITLE = "全市参保人员统计";
	@Resource
	private IAC01Dao ac01Dao;
	@Override
	public ResultModel getAllPersonCount() {
		String querySql = "select AKC021 SUBJECT , sum(AAC006) count from ( select   " +                                        
					      SqlUtil.getCommonSql() + "," +
					      "sum(AAC006) AAC006 " +
					      "from JK_AC01 " +
					      "group by AKC021) group by AKC021";
		List<Object> list = ac01Dao.getSqlData(querySql);
		ResultModel resultModel = ConvertDataToRMUtil.convertDataToRM(list);
		resultModel = convertRM(resultModel);
		resultModel.setTitle(TITLE);
		return resultModel;
	}
	
	private ResultModel convertRM(ResultModel resultModel) {
		Map<String, ArrayList> yAxis = resultModel.getyAxis();
		ArrayList list = yAxis.get("axis");
		for (int i = 0; i < list.size(); i++) {
			String code = (String)list.get(i);
			String name = getNameByCode(code);
			resultModel.getyAxis().get("axis").set(i, name);
		}
		return resultModel;
	}
	
	private String getNameByCode(String code) {
		String name = "";
		switch (code) {
		case "11":
			name = "农合";
			break;
		case "12":
			name = "职工";
			break;
		case "13":
			name = "居民(含农合)";
			break;
		default:
			break;
		}
		return name;
	}
}
